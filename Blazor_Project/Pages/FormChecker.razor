@page "/passwordchecker"
@using Microsoft.AspNetCore.Components.Forms
@using Blazor_Project.Services
@inject PasswordStrengthService passwordCheck
@inject ILogger<FormChecker> logger;

<style>
    .spanColors {
        padding-right: 120px;
        margin-right: 10px;
        border-radius: 4px;
        transition: all 0.4s ease-out;
    }

        .spanColors.invalid {
            background-color: grey;
            outline: none;
        }

        .spanColors.strong {
            background-color: green;
        }

        .spanColors.medium {
            background-color: yellow;
        }

        .spanColors.easy {
            background-color: red;
        }
</style>

<h1 class="pass-title">Password strength</h1>
<div class="pass-input-wrapper">
    <label class="pass-label">
        Supports only a combination of
        <span @class="-invalid: !IsPasswordValid ? 'pass-invalid' : ''">digits/letters/symbols</span>
    </label>
    <InputText class="pass-input" @bind-Value="inputChecker" placeholder="Enter your password here" />

    <div class="pass-marker">
        <span class="@SpanOneClass" id="spanOne"></span>
        <span class="@SpanTwoClass" id="spanTwo"></span>
        <span class="@SpanThreeClass" id="spanThree"></span>
    </div>

    <button @onclick="CheckPassword">Check Password</button>
</div>

@code {
    private string inputChecker = "";
    private bool IsPasswordValid => passwordCheck.IsEasyValidationPassed(inputChecker);
    private bool IsPasswordEasy => passwordCheck.IsEasyValidationPassed(inputChecker);
    private bool IsPasswordMedium => passwordCheck.IsMediumValidationPassed(inputChecker);
    private bool IsPasswordStrong => passwordCheck.IsStrongValidationPassed(inputChecker);


    private string SpanOneClass
    {
        get
        {
            if (string.IsNullOrEmpty(inputChecker))
            {
                return "spanColors invalid";
            }
            else if (inputChecker.Length < 8)
            {
                return "spanColors easy";
            }
            else if (IsPasswordEasy)
            {
                return "spanColors easy";
            }
            else if (IsPasswordMedium)
            {
                return "spanColors medium";
            }
            else if (IsPasswordStrong)
            {
                return "spanColors strong";
            }
            else
            {
                return "spanColors invalid";
            }
        }
    }

    private string SpanTwoClass
    {
        get
        {
            if (string.IsNullOrEmpty(inputChecker))
            {
                return "spanColors invalid";
            }
            else if (inputChecker.Length < 8)
            {
                return "spanColors easy";
            }
            else if (IsPasswordEasy)
            {
                return "spanColors invalid";
            }
            else if (IsPasswordMedium)
            {
                return "spanColors medium";
            }
            else if (IsPasswordStrong)
            {
                return "spanColors strong";
            }
            else
            {
                return "spanColors invalid";
            }
        }
    }

    private string SpanThreeClass
    {
        get
        {
            if (string.IsNullOrEmpty(inputChecker))
            {
                return "spanColors invalid";
            }
            else if (inputChecker.Length < 8)
            {
                return "spanColors easy";
            }
            else if (IsPasswordEasy)
            {
                return "spanColors invalid";
            }
            else if (IsPasswordMedium)
            {
                return "spanColors invalid";
            }
            else if (IsPasswordStrong)
            {
                return "spanColors strong";
            }
            else
            {
                return "spanColors invalid";
            }
        }
    }
    private void CheckPassword()
    {
        if (string.IsNullOrEmpty(inputChecker) || (!IsPasswordEasy && !IsPasswordMedium && !IsPasswordStrong))
        {
            logger.LogInformation("Password is empty or does not meet the criteria.");
        }
        else if (inputChecker.Length < 8)
        {
            logger.LogInformation("Password is invalid. It should be at least 8 characters long.");
        }
        else if (IsPasswordEasy)
        {
            logger.LogInformation("Password is easy.");
        }
        else if (IsPasswordMedium)
        {
            logger.LogInformation("Password is medium.");
        }
        else if (IsPasswordStrong)
        {
            logger.LogInformation("Password is strong.");
        }
    }
}